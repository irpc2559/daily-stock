<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Daily Stock</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

<style>
body{
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro","Helvetica Neue",sans-serif;
  background:#0f1f4b;color:#fff;text-align:center;padding:24px
}
input,select{
  width:240px;height:52px;font-size:22px;text-align:center;
  border-radius:14px;border:none;margin-bottom:12px
}
.keypad button{
  width:70px;height:48px;margin:6px;border:none;border-radius:12px;
  font-size:18px;background:#1c3d8b;color:#fff
}
.primary{
  width:240px;height:52px;border-radius:14px;border:none;
  background:#007aff;color:#fff;font-size:20px
}
</style>
</head>

<body>
<h2>บันทึกการผลิต</h2>

<h3>สถานที่</h3>
<select id="location">
  <option value="">-- เลือกสถานที่ --</option>
  <option value="LOC001">LOC001</option>
</select>

<h3>ค่าเช่า</h3>
<input id="rent" value="0" readonly>

<div class="keypad">
  <button onclick="addRent(1)">1</button>
  <button onclick="addRent(2)">2</button>
  <button onclick="addRent(3)">3</button><br>
  <button onclick="addRent(4)">4</button>
  <button onclick="addRent(5)">5</button>
  <button onclick="addRent(6)">6</button><br>
  <button onclick="addRent(7)">7</button>
  <button onclick="addRent(8)">8</button>
  <button onclick="addRent(9)">9</button><br>
  <button onclick="addRent(0)">0</button>
  <button onclick="delRent()">⌫</button>
</div>

<button class="primary" onclick="submit()">บันทึก</button>

<script>
const LIFF_ID = "2008883092-lVX4JEfG";
const URL_SUBMIT =
"https://defaulteda31a319b9748a88bd8d0897333bb.db.environment.api.powerplatform.com/powerautomate/automations/direct/workflows/eb3f76bcbf41490cb0eb67e3f4478457/triggers/manual/paths/invoke?api-version=1";

liff.init({ liffId: LIFF_ID });

function addRent(n){
  rent.value = rent.value==="0" ? n : rent.value+n;
}
function delRent(){
  rent.value = rent.value.length>1 ? rent.value.slice(0,-1) : "0";
}

async function submit(){
  const payload = {
    date: new Date().toISOString().slice(0,10),
    location: location.value,
    rent: Number(rent.value),
    items: [
      { product_id:"P01", produce:10, waste:2, remain:8 }
    ]
  };

  const res = await fetch(URL_SUBMIT,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify(payload)
  });

  if(res.ok){
    alert("บันทึกเรียบร้อย");
    liff.closeWindow();
  }else{
    alert("บันทึกไม่สำเร็จ");
  }
}
</script>
</body>
</html>
